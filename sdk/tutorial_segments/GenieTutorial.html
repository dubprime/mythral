<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick Start: Hello, World! &mdash; IA-SDK-Python 0.3.11 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> IA-SDK-Python
            <img src="../_static/ia_with_text_white.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v0.3.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GDF.html">GAIuS Data Format (GDF)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GDF.html#fields">Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../GDF.html#strings">strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GDF.html#vectors">vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GDF.html#emotives">emotives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GDF.html#metadata">metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GDF.html#path">path</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Quick%20Start%20-%20Hello%2C%20World%21.html">Quick Start: Hello, World!</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Quick%20Start%20-%20Hello%2C%20World%21.html#Four-API-Calls">Four API Calls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Genome%20Introduction.html">Create a Genome Topology for your Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Agent%20Creation.html">Deploy an Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Agent%20Creation.html#Connect-to-Your-Agent">Connect to Your Agent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Agent%20Creation.html#Use-the-SDK’s-AgentClient">Use the SDK’s AgentClient</a></li>
<li class="toctree-l3"><a class="reference internal" href="Agent%20Creation.html#Or,-roll-your-own-connections">Or, roll your own connections</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Agent%20Observe%20Strings.html">Interact with your Agent using String Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Agent%20Observe%20Strings.html#Data-Preparation">Data Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Agent%20Observe%20Strings.html#Observing-data">Observing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Agent%20Observe%20Strings.html#Observe-1st-Sequence">Observe 1st Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Agent%20Observe%20Strings.html#Learn-1st-Sequence">Learn 1st Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Agent%20Observe%20Strings.html#Observe-2nd-Sequence">Observe 2nd Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Agent%20Observe%20Strings.html#Learn-2nd-Sequence">Learn 2nd Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Agent%20Observe%20Strings.html#Show-Agent-Status">Show Agent Status</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Agent%20Observe%20Strings.html#Get-Predictions">Get Predictions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Agent%20Observe%20Emotives.html">An Emotional Machine: Emotives and Mood</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../AgentClient.html">AgentClient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Genome.html">Genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb_ops.html">KB Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ops.html">Data Ops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data_ops.html#data">Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data_ops.html#datarecords">DataRecords</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data_ops.html#data-ops-module">data_ops module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PVT.html">Performance Validation Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../PVT.html#performance-validation-test">Performance Validation Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PVT.html#mongodata">MongoData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PVT.html#mongodatarecords">MongoDataRecords</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PVT.html#mongoresults">MongoResults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PVT.html#module-ia.gaius.pvt.pvt_utils">PVT Utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../prediction_models.html">Prediction Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ia.gaius.html">ia.gaius package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ia.gaius.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ia.gaius.tests.html">ia.gaius.tests package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../ia.gaius.tests.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ia.gaius.tests.html#module-ia.gaius.tests.classification">ia.gaius.tests.classification module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ia.gaius.tests.html#module-ia.gaius.tests.utility">ia.gaius.tests.utility module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ia.gaius.tests.html#module-ia.gaius.tests">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ia.gaius.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ia.gaius.html#module-ia.gaius.back_testing">ia.gaius.back_testing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ia.gaius.html#module-ia.gaius.data_language">ia.gaius.data_language module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ia.gaius.html#module-ia.gaius.prediction_models">ia.gaius.prediction_models module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IA-SDK-Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Quick Start: Hello, World!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial_segments/GenieTutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><img alt="e3b7c321046949a987383cfee4509dd4" class="no-scaled-link" src="http://files.intelligent-artifacts.com/horizontal-black-green&#64;2x.png" style="width: 300px;" /></p>
<section id="Quick-Start:-Hello,-World!">
<h1>Quick Start: Hello, World!<a class="headerlink" href="#Quick-Start:-Hello,-World!" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update your agent information, and then connect to it</span>
<span class="kn">from</span> <span class="nn">ia.gaius.agent_client</span> <span class="kn">import</span> <span class="n">AgentClient</span>

<span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;&lt;YOUR-API-KEY-HERE&gt;&#39;</span>
<span class="n">name</span>    <span class="o">=</span> <span class="s1">&#39;&lt;YOUR-AGENT-NAME-HERE&gt;&#39;</span>
<span class="n">domain</span>  <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">secure</span>  <span class="o">=</span> <span class="kc">True</span>

<span class="n">agent_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span>  <span class="n">name</span><span class="p">,</span>
               <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="n">domain</span><span class="p">,</span>
               <span class="s1">&#39;secure&#39;</span><span class="p">:</span> <span class="n">secure</span><span class="p">}</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCD-1234&#39;</span><span class="p">,</span>
              <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
              <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="s1">&#39;gaius-api:80&#39;</span><span class="p">,</span>
              <span class="s1">&#39;secure&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">AgentClient</span><span class="p">(</span><span class="n">agent_info</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;connection&#39;: &#39;okay&#39;, &#39;agent&#39;: &#39;simple&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use only one node</span>
<span class="n">ingress_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>
<span class="n">query_nodes</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>

<span class="n">agent</span><span class="o">.</span><span class="n">set_ingress_nodes</span><span class="p">(</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">set_query_nodes</span><span class="p">(</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;id&#39;: &#39;p46b6b076c&#39;, &#39;name&#39;: &#39;P1&#39;}]
</pre></div></div>
</div>
<section id="Four-API-Calls">
<h2>Four API Calls<a class="headerlink" href="#Four-API-Calls" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clear working memory</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="c1"># agent.clear_wm()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;wm-cleared&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_1</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>

<span class="c1"># Observe a sequence of events</span>
<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence_1</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learn a sequence</span>
<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MODEL|7d0678ba6305341ce0d25133ab086208656a562f&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Observe new data</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;observed&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Predictions</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;confidence&#39;: 1,
  &#39;confluence&#39;: 0.5,
  &#39;emotives&#39;: {},
  &#39;entropy&#39;: 0.5,
  &#39;evidence&#39;: 0.5,
  &#39;extras&#39;: [],
  &#39;fragmentation&#39;: 0,
  &#39;frequency&#39;: 3,
  &#39;future&#39;: [[&#39;world&#39;]],
  &#39;grand_hamiltonian&#39;: 0.5,
  &#39;hamiltonian&#39;: 0,
  &#39;itfdf_similarity&#39;: 1,
  &#39;matches&#39;: [&#39;hello&#39;],
  &#39;missing&#39;: [],
  &#39;name&#39;: &#39;7d0678ba6305341ce0d25133ab086208656a562f&#39;,
  &#39;past&#39;: [],
  &#39;potential&#39;: 3.5,
  &#39;present&#39;: [[&#39;hello&#39;]],
  &#39;similarity&#39;: 0.666666687,
  &#39;snr&#39;: 1,
  &#39;type&#39;: &#39;prototypical&#39;}]
</pre></div></div>
</div>
</section>
</section>
<section id="Gaius-Tutorial">
<h1>Gaius Tutorial<a class="headerlink" href="#Gaius-Tutorial" title="Permalink to this heading"></a></h1>
<p>This is a tutorial for Intelligent Artifacts. It is a general evolving networked intelligence engine, i.e. an Artificial General Intelligence platform, built on top of Intelligent Artifacts’ GAIuS AGI framework. In order to proceed with this tutorial, you need to sign up for access to the Gaius platform. Please contact your Intelligent Artifacts representative if you need help getting access to the Gaius platform.</p>
<section id="Gaius-Tutorial-Overview">
<h2>Gaius Tutorial Overview<a class="headerlink" href="#Gaius-Tutorial-Overview" title="Permalink to this heading"></a></h2>
1. Create a Genome Topology for your Agent
2. Spawn a Bottle for your Agent
3. Connect to your Agent
4. Interact with your Agent using String Data
    5a. Data Preparation
    5b. Observing Data
    5c. Learning Data
    5d. Get Predictions
5. An Emotional Machine: Emotives and Mood
6. Numerical Data: Vectors
7. Attaching Manipulatives
    7a. Manipulatives
    7b. Abstractions and Deep Learning
8. Gaius Examples
    8a. Classification
    8b. Utility Polarity
    8c. Utility Value
9. Advanced Gaius Examples
    9a. Building a Recommendation Engine with Emotives</section>
</section>
<section id="1.-Create-a-Genome-Topology-for-your-Agent">
<h1>1. Create a Genome Topology for your Agent<a class="headerlink" href="#1.-Create-a-Genome-Topology-for-your-Agent" title="Permalink to this heading"></a></h1>
<p>In order to create a agent you first need to create its genome. An agent’s genome is very much like a genome in biology where it is an organism’s complete set of genetic instructions. In this case, the genome is for an AI agent. A genome can be created manually, algorithmically, or using the Intelligent Artifacts Lab GUI (Lab). For now let’s a genome that is located in the config folder named, ‘demo-all.’ All you need to do is upload the Genome in the Lab’s Topology Creator. Moreover, a genome
can be downloaded and uploaded for later use or sharing after spawning an agent (covered in the next section below). The genome file is a JavaScript Object Notation (JSON) string that can be imported as below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ia.gaius.genome_info</span> <span class="kn">import</span> <span class="n">Genome</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">genome_topology</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{&quot;elements&quot;:{&quot;nodes&quot;:[{&quot;data&quot;:{&quot;name&quot;:&quot;P1&quot;,&quot;id&quot;:&quot;p7ae0a0612&quot;,&quot;type&quot;:&quot;primitive&quot;,&quot;sources&quot;:[&quot;observables&quot;],&quot;manipulatives&quot;:[],&quot;always_update_frequencies&quot;:false,&quot;auto_act_method&quot;:&quot;none&quot;,&quot;auto_act_threshold&quot;:0.8,&quot;auto_learn_method&quot;:&quot;none&quot;,&quot;classifier&quot;:&quot;CVC&quot;,&quot;datastore&quot;:&quot;mongodb&quot;,&quot;dynamic_sequence_length&quot;:true,&quot;max_sequence_length&quot;:0,&quot;sort&quot;:true,&quot;process_predictions&quot;:true,&quot;quiescence&quot;:3,&quot;search_depth&quot;:10,&quot;recall_threshold&quot;:0.1,&quot;smoothness&quot;:3,&quot;max_predictions&quot;:100,&quot;persistence&quot;:5},&quot;position&quot;:{&quot;x&quot;:587,&quot;y&quot;:272.5975},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;name&quot;:&quot;P2&quot;,&quot;id&quot;:&quot;p5b55a8399&quot;,&quot;type&quot;:&quot;primitive&quot;,&quot;sources&quot;:[&quot;m44ee0fd21&quot;],&quot;manipulatives&quot;:[&quot;m44ee0fd21&quot;],&quot;always_update_frequencies&quot;:false,&quot;auto_act_method&quot;:&quot;none&quot;,&quot;auto_act_threshold&quot;:0.8,&quot;auto_learn_method&quot;:&quot;none&quot;,&quot;classifier&quot;:&quot;CVC&quot;,&quot;datastore&quot;:&quot;mongodb&quot;,&quot;dynamic_sequence_length&quot;:true,&quot;max_sequence_length&quot;:0,&quot;sort&quot;:true,&quot;process_predictions&quot;:true,&quot;quiescence&quot;:3,&quot;search_depth&quot;:10,&quot;recall_threshold&quot;:0.1,&quot;smoothness&quot;:3,&quot;max_predictions&quot;:100,&quot;persistence&quot;:5},&quot;position&quot;:{&quot;x&quot;:687,&quot;y&quot;:272.5975},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;name&quot;:&quot;P3&quot;,&quot;id&quot;:&quot;p85643c122&quot;,&quot;type&quot;:&quot;primitive&quot;,&quot;sources&quot;:[&quot;observables&quot;],&quot;manipulatives&quot;:[&quot;mb94faab95&quot;],&quot;always_update_frequencies&quot;:false,&quot;auto_act_method&quot;:&quot;none&quot;,&quot;auto_act_threshold&quot;:0.8,&quot;auto_learn_method&quot;:&quot;none&quot;,&quot;classifier&quot;:&quot;CVC&quot;,&quot;datastore&quot;:&quot;mongodb&quot;,&quot;dynamic_sequence_length&quot;:true,&quot;max_sequence_length&quot;:0,&quot;sort&quot;:true,&quot;process_predictions&quot;:true,&quot;quiescence&quot;:3,&quot;search_depth&quot;:10,&quot;recall_threshold&quot;:0.1,&quot;smoothness&quot;:3,&quot;max_predictions&quot;:100,&quot;persistence&quot;:5},&quot;position&quot;:{&quot;x&quot;:789,&quot;y&quot;:271.5975},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;displayName&quot;:&quot;Multiplier&quot;,&quot;mtype&quot;:&quot;normal&quot;,&quot;name&quot;:&quot;emotiveMultiplier&quot;,&quot;inputs&quot;:[&quot;strings&quot;,&quot;emotives&quot;,&quot;vectors&quot;],&quot;outputs&quot;:[&quot;strings&quot;,&quot;emotives&quot;,&quot;vectors&quot;,&quot;predictions&quot;],&quot;description&quot;:&quot;Multiplies emotive values by a configurable value.&quot;,&quot;tags&quot;:[&quot;emotives&quot;,&quot;multiply&quot;,&quot;multiplication&quot;,&quot;multi&quot;,&quot;value&quot;,&quot;factor&quot;],&quot;category&quot;:&quot;emotives&quot;,&quot;genes&quot;:{&quot;sources&quot;:{&quot;alleles&quot;:[],&quot;mutability&quot;:0,&quot;value&quot;:[&quot;observables&quot;],&quot;volatility&quot;:0},&quot;multiplier&quot;:{&quot;alleles&quot;:[1,2,3,4,5,6,7,8,9,10],&quot;mutability&quot;:0,&quot;value&quot;:5,&quot;volatility&quot;:0}},&quot;id&quot;:&quot;m44ee0fd21&quot;,&quot;type&quot;:&quot;manipulative&quot;,&quot;primitive&quot;:&quot;p5b55a8399&quot;},&quot;position&quot;:{&quot;x&quot;:687,&quot;y&quot;:372.5975},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;displayName&quot;:&quot;abstraction&quot;,&quot;name&quot;:&quot;abstraction&quot;,&quot;category&quot;:&quot;standard&quot;,&quot;mtype&quot;:&quot;output&quot;,&quot;description&quot;:&quot;Output manipulative to forward abstracted predictions to other Primitives. The chosen field of the predictions are forwarded as. The are also forwarded. No are forwarded.&quot;,&quot;tags&quot;:[&quot;abstraction&quot;,&quot;name&quot;,&quot;present&quot;,&quot;past&quot;,&quot;future&quot;,&quot;missing&quot;,&quot;matches&quot;,&quot;extras&quot;,&quot;output&quot;,&quot;forward&quot;,&quot;abstract&quot;,&quot;emotives&quot;,&quot;strings&quot;,&quot;emotive&quot;,&quot;classification&quot;],&quot;genes&quot;:{&quot;sources&quot;:{&quot;alleles&quot;:[],&quot;mutability&quot;:0,&quot;value&quot;:[&quot;cognition-data&quot;],&quot;volatility&quot;:0},&quot;primitives&quot;:{&quot;alleles&quot;:[],&quot;mutability&quot;:0,&quot;value&quot;:[&quot;pc4dff12d6&quot;],&quot;volatility&quot;:0},&quot;field&quot;:{&quot;alleles&quot;:[&quot;name&quot;,&quot;past&quot;,&quot;present&quot;,&quot;future&quot;,&quot;missing&quot;,&quot;extras&quot;,&quot;matches&quot;,&quot;classification&quot;],&quot;mutability&quot;:0,&quot;value&quot;:[&quot;name&quot;],&quot;volatility&quot;:0}},&quot;id&quot;:&quot;mb94faab95&quot;,&quot;type&quot;:&quot;manipulative&quot;,&quot;primitive&quot;:&quot;p85643c122&quot;},&quot;position&quot;:{&quot;x&quot;:789,&quot;y&quot;:171.59750000000003},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;name&quot;:&quot;P4&quot;,&quot;id&quot;:&quot;pc4dff12d6&quot;,&quot;type&quot;:&quot;primitive&quot;,&quot;sources&quot;:[&quot;observables&quot;],&quot;manipulatives&quot;:[],&quot;always_update_frequencies&quot;:false,&quot;auto_act_method&quot;:&quot;none&quot;,&quot;auto_act_threshold&quot;:0.8,&quot;auto_learn_method&quot;:&quot;none&quot;,&quot;classifier&quot;:&quot;CVC&quot;,&quot;datastore&quot;:&quot;mongodb&quot;,&quot;dynamic_sequence_length&quot;:true,&quot;max_sequence_length&quot;:0,&quot;sort&quot;:true,&quot;process_predictions&quot;:true,&quot;quiescence&quot;:3,&quot;search_depth&quot;:10,&quot;recall_threshold&quot;:0.1,&quot;smoothness&quot;:3,&quot;max_predictions&quot;:100,&quot;persistence&quot;:5},&quot;position&quot;:{&quot;x&quot;:788,&quot;y&quot;:81.59750000000003},&quot;group&quot;:&quot;nodes&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:false,&quot;classes&quot;:&quot;&quot;}],&quot;edges&quot;:[{&quot;data&quot;:{&quot;id&quot;:&quot;eb7965422f&quot;,&quot;source&quot;:&quot;m44ee0fd21&quot;,&quot;target&quot;:&quot;p5b55a8399&quot;,&quot;type&quot;:&quot;edge&quot;},&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:0},&quot;group&quot;:&quot;edges&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:true,&quot;classes&quot;:&quot;&quot;},{&quot;data&quot;:{&quot;id&quot;:&quot;ec26380337&quot;,&quot;source&quot;:&quot;p85643c122&quot;,&quot;target&quot;:&quot;mb94faab95&quot;,&quot;type&quot;:&quot;edge&quot;},&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:0},&quot;group&quot;:&quot;edges&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:true,&quot;classes&quot;:&quot;abstractionEdge&quot;},{&quot;data&quot;:{&quot;id&quot;:&quot;e5dd3a5044&quot;,&quot;source&quot;:&quot;mb94faab95&quot;,&quot;target&quot;:&quot;pc4dff12d6&quot;,&quot;type&quot;:&quot;edge&quot;},&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:0},&quot;group&quot;:&quot;edges&quot;,&quot;removed&quot;:false,&quot;selected&quot;:false,&quot;selectable&quot;:false,&quot;locked&quot;:false,&quot;grabbable&quot;:true,&quot;pannable&quot;:true,&quot;classes&quot;:&quot;abstractionEdge&quot;}]},&quot;style&quot;:[{&quot;selector&quot;:&quot;edge&quot;,&quot;style&quot;:{&quot;target-arrow-shape&quot;:&quot;triangle&quot;,&quot;curve-style&quot;:&quot;straight&quot;,&quot;control-point-distances&quot;:10,&quot;control-point-weights&quot;:0.1,&quot;width&quot;:1,&quot;overlay-color&quot;:&quot;#fff&quot;}},{&quot;selector&quot;:&quot;edge.curved&quot;,&quot;style&quot;:{&quot;curve-style&quot;:&quot;bezier&quot;}}],&quot;data&quot;:</span><span class="si">{}</span><span class="s1">,&quot;zoomingEnabled&quot;:true,&quot;userZoomingEnabled&quot;:true,&quot;zoom&quot;:1,&quot;minZoom&quot;:1e-50,&quot;maxZoom&quot;:1,&quot;panningEnabled&quot;:true,&quot;userPanningEnabled&quot;:true,&quot;pan&quot;:{&quot;x&quot;:0,&quot;y&quot;:0},&quot;boxSelectionEnabled&quot;:false,&quot;renderer&quot;:{&quot;name&quot;:&quot;canvas&quot;},&quot;wheelSensitivity&quot;:0.1,&quot;motionBlur&quot;:false,&quot;agent&quot;:&quot;demo-all&quot;,&quot;description&quot;:&quot;tutorial&quot;}&#39;&#39;&#39;</span>
<span class="n">genome</span> <span class="o">=</span> <span class="n">Genome</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">genome_topology</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Parameter values in genomes are intended to be modified. Since the genome file is a JSON object, modifying values is easy. You can also use the Genome object class to easily find nodes and values for modification.</p>
<p>The following example will change the <code class="docutils literal notranslate"><span class="pre">'recall_threshold'</span></code> and <code class="docutils literal notranslate"><span class="pre">'max_predictions'</span></code> of the primitive ‘P1’:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">genome</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;recall_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;max_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2"> ID               : </span><span class="si">%s</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2"> Recall Threshold : </span><span class="si">%s</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2"> Max Predictions  : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;recall_threshold&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;max_predictions&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P4:
 ID               : pc4dff12d6
 Recall Threshold : 0.1
 Max Predictions  : 100
</pre></div></div>
</div>
</section>
<section id="2.-Deploy-an-Agent">
<h1>2. Deploy an Agent<a class="headerlink" href="#2.-Deploy-an-Agent" title="Permalink to this heading"></a></h1>
<p>Once a Genome has been uploaded or created on lab, it is possible to deploy an agent. In the sidebar, select the Genome from the Perception Manifold area. Find the Genome named ‘demo-all’, next select an agent size, then select ‘M’ for ‘medium’. This will deploy an agent using the Genome topology. On the dashboard page you can see the status of your agent as it is created.</p>
<p>An agent is a computer in the cloud (server, virtual machine) or local machine preconfigured with the GAIuS operating system. On IA’s cloud, this is done automatically through the Lab when spawning a new agent.</p>
<p>After a few minutes, a new agent should appear in the ‘Deployed Agents’ area of the sidebar. Click on your agent. If following along, copy and paste the agent name and the api key into the agent_info below.</p>
</section>
<section id="3.-Connect-to-Your-Agent">
<h1>3. Connect to Your Agent<a class="headerlink" href="#3.-Connect-to-Your-Agent" title="Permalink to this heading"></a></h1>
<p>You have options on how to connect to a running agent. You can use the provided SDK in your preferred language, or roll your own.</p>
<p>Install the Python version of the SDK via:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">ia-sdk</span></code></p>
<p>or, if using the Jupyter for Intelligent Artifacts container, open a terminal and update it with:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">-U</span> <span class="pre">ia-sdk</span></code></p>
<p>To check the current sdk version:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">show</span> <span class="pre">ia-sdk</span></code></p>
<p>The AgentClient in the SDK requires only the URL and api key. Once you connect, you can define the ingress and query nodes for the agent. Each AgentClient can define its own ingress and query nodes. This allows multiple inputs sources to connect to different ingress nodes of the agent, as well as allowing to query different Cognitive Processors for answers.</p>
<p>For example, to connect to a cloud agent:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># update your bottle information, and then connect to it
api_key = &#39;&lt;secret-api-key-here&gt;&#39;
name    = &#39;&lt;bottle-name-here&gt;&#39;
domain  = &#39;intelligent-artifacts.com&#39;
secure  = True

from ia.gaius.agent_client import AgentClient

agent_info = {&#39;api_key&#39;: api_key,
               &#39;name&#39;:  name,
               &#39;domain&#39;: domain,
               &#39;secure&#39;: secure}
agent = AgentClient(agent_info)
agent.connect()
agent
</pre></div>
</div>
<p>To connect to a local agent:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from ia.gaius.agent_client import AgentClient

agent_info = {&#39;api_key&#39;: &#39;ABCD-1234&#39;,
               &#39;name&#39;:  &#39;&#39;,
               &#39;domain&#39;: &#39;&lt;agent&gt;:&lt;port&gt;&#39;,
               &#39;secure&#39;: False}
agent = AgentClient(agent_info)
agent.connect()
agent
</pre></div>
</div>
<p>For local agents it may be necessary to connect to the docker network, if connecting via another docker container</p>
<p>To roll your own, you simply need the agent’s host and domain names, the secret API key, and the IDs of each primitive you’d like to connect. You can use a library like Python’s <code class="docutils literal notranslate"><span class="pre">requests</span></code> to POST data and query the primitives.</p>
<p>For example:</p>
<p>Let’s connect to either a local or a cloud agent</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import requests

# Local Agent Info
name    = &#39;agent&#39;
api_key = &#39;ABCD-1234&#39;

# connect to local agent with http
requests.get(f&quot;http://{name}/connect&quot;,
             headers={&#39;X-API-KEY&#39;: api_key}).json()

# Cloud Agent Info
name    = &#39;&lt;agent-name-here&gt;&#39;
domain  = &#39;intelligent-artifacts.com&#39;
api_key = &#39;&lt;secret-api-key-here&gt;&#39;

# connect to a cloud agent with https and domain
requests.get(f&quot;https://{name}.{domain}/connect&quot;,
             headers={&#39;X-API-KEY&#39;: api_key}).json()
</pre></div>
</div>
<p>To observe data:</p>
<p>In order to observe data you need to have the primitive ids of the Cognitive Processors. If you don’t know the ids, you can retrieve them by connecting to the agent with request first.</p>
<p>The following examples are for cloud bottles.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># data as a GDF you want to observe
data = {&quot;strings&quot;: [&quot;hello&quot;,&quot;world&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}

agent_connection_info = requests.get(f&quot;https://{name}.{domain}/connect&quot;,
             headers={&#39;X-API-KEY&#39;: api_key}).json()

# navigate into the bottle_connection_info dictionary to get primitive ids from genome data
primitive_id = agent_connection_info[&#39;genome&#39;][&#39;elements&#39;][&#39;nodes&#39;][0][&#39;data&#39;][&#39;id&#39;]

# observe data
requests.post(f&quot;https://{name}.{domain}/{primitive_id}/observe&quot;,
              headers={&#39;X-API-KEY&#39;: api_key},
              json={&#39;data&#39;: data}).json()
</pre></div>
</div>
<p>To learn data:</p>
<p>After you’ve observed a few events</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>requests.post(f&quot;https://{name}.{domain}/{primitive_id}/learn&quot;,
              headers={&#39;X-API-KEY&#39;: api_key}).json()
</pre></div>
</div>
<p>To query for answers:</p>
<p>After you’ve observed additional data, one can try to get predictions</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># data as a GDF you want to observe in order to get predictions
data = {&quot;strings&quot;: [&quot;hello&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}

# observe data
requests.post(f&quot;https://{name}.{domain}/{primitive_id}/observe&quot;,
              headers={&#39;X-API-KEY&#39;: api_key},
              json={&#39;data&#39;: data}).json()

requests.post(f&quot;https://{name}.{domain}/{primitive_id}/predictions&quot;,
              headers={&#39;X-API-KEY&#39;: api_key}).json()
</pre></div>
</div>
<p>To get a fresh start, one can</p>
<p>clear all memory of the Cognitive Processor:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>requests.post(f&quot;https://{name}.{domain}/{primitive_id}/clear-all-memory&quot;,
              headers={&#39;X-API-KEY&#39;: api_key}).json()
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The sdk version used in this tutorial</span>
<span class="o">!</span>pip3 show ia-sdk
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update your agent information, and then connect to it</span>
<span class="kn">from</span> <span class="nn">ia.gaius.agent_client</span> <span class="kn">import</span> <span class="n">AgentClient</span>

<span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;&lt;YOUR-API-KEY-HERE&gt;&#39;</span>
<span class="n">name</span>    <span class="o">=</span> <span class="s1">&#39;&lt;YOUR-AGENT-NAME-HERE&gt;&#39;</span>
<span class="n">domain</span>  <span class="o">=</span> <span class="s1">&#39;intelligent-artifacts.com&#39;</span>
<span class="n">secure</span>  <span class="o">=</span> <span class="kc">True</span>

<span class="n">agent_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span>  <span class="n">name</span><span class="p">,</span>
               <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="n">domain</span><span class="p">,</span>
               <span class="s1">&#39;secure&#39;</span><span class="p">:</span> <span class="n">secure</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCD-1234&#39;</span><span class="p">,</span>
              <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
              <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="s1">&#39;gaius-api:80&#39;</span><span class="p">,</span>
              <span class="s1">&#39;secure&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">AgentClient</span><span class="p">(</span><span class="n">agent_info</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">agent</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;.gaius-api:80| secure: False, connected: True, gaius_agent: simple,                   ingress_nodes: 0, query_nodes: 0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use only one node</span>
<span class="n">ingress_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>
<span class="n">query_nodes</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>

<span class="n">agent</span><span class="o">.</span><span class="n">set_ingress_nodes</span><span class="p">(</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">set_query_nodes</span><span class="p">(</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;id&#39;: &#39;p46b6b076c&#39;, &#39;name&#39;: &#39;P1&#39;}]
</pre></div></div>
</div>
</section>
<section id="4.-Interact-with-your-Agent-using-String-Data">
<h1>4. Interact with your Agent using String Data<a class="headerlink" href="#4.-Interact-with-your-Agent-using-String-Data" title="Permalink to this heading"></a></h1>
<section id="4a.-Data-Preparation">
<h2>4a. Data Preparation<a class="headerlink" href="#4a.-Data-Preparation" title="Permalink to this heading"></a></h2>
<p>All data provided to a GAIuS Agent is supplied as sequences of events. The way a sequence is delimited depends on the problem domain</p>
<p>An event is a single occurrence of a process.</p>
<p>A sequence is a particular order in which related events, movements, or things follow each other.</p>
<p>sequence = [event_1, event_2, …, event_n]</p>
<p>Even problems that don’t initially appear to be sequence problems can be cast into this form. For example, customer profile data can be converted into a sequence of a single event. It is common to call such single-evented sequences profile data to distinguish them from other sequences.</p>
<p>sequence = [event_1]</p>
<p>can be represented as</p>
<p>sequence = [profile_data]</p>
<p>Each event must be formatted into our universal input format, the GAIuS Data Format (GDF) object.</p>
<p>The GDF object is a JSON object that has three core fields: strings, vectors, and emotives. Each field’s value is an array of relevant data. All three fields must be provided even if they are empty. GDFs are easily shared between systems because they are JSON objects.</p>
<p>Here is an empty GDF:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&quot;strings&quot;: [], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}
</pre></div>
</div>
<p>In general and simply put, the strings field is for text-based data, the vectors field is for arrays of numerical data, and the emotives field is for emotional data, a non-vector number, positive or negative. The GDF object is the key for using our AGI platform. Practically any data can be converted into this form.</p>
<p>For now let’s focus on string data:</p>
<p>A string is simply any character, e.g. “h”, or sequential characters, “hello”. Strings must be properly delimited with double-quotes. This conforms with the JSON standard for strings.</p>
<p>GDFs provide the ability to observe single events. Multiple events build sequences. For example, the following is one sequence:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[{&quot;strings&quot;: [&quot;hello&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;world&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}]
</pre></div>
</div>
<p>This sequence consists of two events. The first event consists of the symbol “hello” in the <code class="docutils literal notranslate"><span class="pre">&quot;strings&quot;</span></code> field. The second event consists of the symbol “world” in the <code class="docutils literal notranslate"><span class="pre">&quot;strings&quot;</span></code> field.</p>
<p>Here’s another example of a sequence:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[{&quot;strings&quot;: [&quot;goodbye&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;cruel&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;world&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}]
</pre></div>
</div>
<p>Having defined the ingress and query nodes earlier, let’s use your AgentClient to send data and query the agent.</p>
</section>
<section id="4b.-Observing-data">
<h2>4b. Observing data<a class="headerlink" href="#4b.-Observing-data" title="Permalink to this heading"></a></h2>
<p>Sending data requires the <code class="docutils literal notranslate"><span class="pre">observe</span></code> API call. The AgentClient provides this using a similarly named function.</p>
<p>In order to acquire and process data you need to first make an observation. When the GAIuS Agent observes data it observes each event of a sequence one-by-one where the data is processed into the working memory (WM). Data processed into the WM can later be used to make predictions or be learned where it will update its knowlege base (KB). Data stored in the KB will be used to pattern match and make predictions. Analogously, you can think of WM as short term memory and KB as long term memory. It
is good practice to clear the WM before the Agent observes new data to ensure that the state of the Agent is as expected.</p>
<p>Let’s follow this sequence of steps to observe and process new data:</p>
<ol class="arabic simple">
<li><p>agent.clear_wm() - clear wm to make sure nothing is in the wm</p></li>
<li><p>agent.observe(event) - observe new data</p></li>
<li><p>agent.get_wm() - to look at what’s in the wm after an observation was made</p></li>
<li><p>agent.clear_all_memory - when we want a fresh start we would want to clear everything in the wm and the kb</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;wm-cleared&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;observed&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;hello&#39;]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;all-cleared&#39;
</pre></div></div>
</div>
<p>The reason for the Gaius platform is for it to observe data, learn from it, and to provide predictions. Let’s go ahead and put this all together using what we’ve learned above.</p>
<p>Let’s train on the two sequences:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[{&quot;strings&quot;: [&quot;hello&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;world&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}]
</pre></div>
</div>
<p>and</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[{&quot;strings&quot;: [&quot;goodbye&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;cruel&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}},
 {&quot;strings&quot;: [&quot;world&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}]
</pre></div>
</div>
<section id="Observe-1st-Sequence">
<h3>Observe 1st Sequence<a class="headerlink" href="#Observe-1st-Sequence" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span> <span class="c1">### Start with a clean slate.</span>

<span class="n">sequence_1</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence_1</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;hello&#39;], [&#39;world&#39;]]
</pre></div></div>
</div>
</section>
<section id="Learn-1st-Sequence">
<h3>Learn 1st Sequence<a class="headerlink" href="#Learn-1st-Sequence" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The first sequence is fully in working memory (WM) now.  Let&#39;s learn it!</span>
<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MODEL|7d0678ba6305341ce0d25133ab086208656a562f&#39;
</pre></div></div>
</div>
</section>
<section id="Observe-2nd-Sequence">
<h3>Observe 2nd Sequence<a class="headerlink" href="#Observe-2nd-Sequence" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Let&#39;s now observe and learn the next sequence.</span>

<span class="c1">## Just in case, let&#39;s clear out the working memory (WM), though &#39;learn&#39; does that for us already.</span>
<span class="c1">## Don&#39;t clear out ALL the memory, otherwise it will forget the sequences it learned!</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

<span class="n">sequence_2</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;goodbye&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cruel&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence_2</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Learn-2nd-Sequence">
<h3>Learn 2nd Sequence<a class="headerlink" href="#Learn-2nd-Sequence" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## The second sequence is fully in working memory (WM) now.  Let&#39;s learn it!</span>
<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MODEL|3b5c9cdc4424988308922d2ec8c7bc06b7c6ac21&#39;
</pre></div></div>
</div>
<p>At this point, we’ve taught the agent two sequences. Let us check how much sequences were learned in its kb. Now let’s now observe new data, and request some predictions back:</p>
</section>
<section id="Show-Agent-Status">
<h3>Show Agent Status<a class="headerlink" href="#Show-Agent-Status" title="Permalink to this heading"></a></h3>
<p>Sometimes it is helpful to view information about the agent’s current state, especially how many sequences are in the KB. You can do this using the API command agent.show_status()</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;PREDICT&#39;: True,
 &#39;SLEEPING&#39;: False,
 &#39;emotives&#39;: {},
 &#39;last_learned_model_name&#39;: &#39;3b5c9cdc4424988308922d2ec8c7bc06b7c6ac21&#39;,
 &#39;models_kb&#39;: &#39;{KB| objects: 2}&#39;,
 &#39;name&#39;: &#39;P1&#39;,
 &#39;size_WM&#39;: 0,
 &#39;target&#39;: &#39;&#39;,
 &#39;time&#39;: 5,
 &#39;vectors_kb&#39;: &#39;{KB| objects: 0}&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at how many sequences the agent has learned</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)[</span><span class="s1">&#39;models_kb&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;{KB| objects: 2}&#39;
</pre></div></div>
</div>
</section>
</section>
<section id="4d.-Get-Predictions">
<h2>4d. Get Predictions<a class="headerlink" href="#4d.-Get-Predictions" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Again, we want to ensure there&#39;s nothing in the working memory (WM) before we send it new sequences:</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;observed&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;confidence&#39;: 1,
  &#39;confluence&#39;: 0.4,
  &#39;emotives&#39;: {},
  &#39;entropy&#39;: 0.464385629,
  &#39;evidence&#39;: 0.5,
  &#39;extras&#39;: [],
  &#39;fragmentation&#39;: 0,
  &#39;frequency&#39;: 1,
  &#39;future&#39;: [[&#39;world&#39;]],
  &#39;grand_hamiltonian&#39;: 0.232192814,
  &#39;hamiltonian&#39;: 0,
  &#39;itfdf_similarity&#39;: 1,
  &#39;matches&#39;: [&#39;hello&#39;],
  &#39;missing&#39;: [],
  &#39;name&#39;: &#39;7d0678ba6305341ce0d25133ab086208656a562f&#39;,
  &#39;past&#39;: [],
  &#39;potential&#39;: 3.5,
  &#39;present&#39;: [[&#39;hello&#39;]],
  &#39;similarity&#39;: 0.666666687,
  &#39;snr&#39;: 1,
  &#39;type&#39;: &#39;prototypical&#39;}]
</pre></div></div>
</div>
<p>‘P1’ has provided an ensemble of predictions for us! This ensemble, however, only has one prediction. The prediction is the first sequence that we taught it. It is represented as a prediction object. This is our universal output format. Let’s look at some of the fields and values it provides:</p>
<p>It states that it has matched on the <code class="docutils literal notranslate"><span class="pre">'hello'</span></code> symbol:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;matches&#39;: [&#39;hello&#39;]
</pre></div>
</div>
<p>From this, it believes that the current present state of affairs is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;present&#39;: [[&#39;hello&#39;]]
</pre></div>
</div>
<p>That’s one event with the <code class="docutils literal notranslate"><span class="pre">'hello'</span></code> symbol and nothing else.</p>
<p>Having identified it’s believed present state, it predicts that the future will consist of the following event states:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;future&#39;: [[&#39;world&#39;]]
</pre></div>
</div>
<p>That’s just one more event consisting of the <code class="docutils literal notranslate"><span class="pre">'world'</span></code> symbol.</p>
<p>Let’s now complete this sequence for the agent:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;observed&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;confidence&#39;: 1,
  &#39;confluence&#39;: 0.46,
  &#39;emotives&#39;: {},
  &#39;entropy&#39;: 0.99315685,
  &#39;evidence&#39;: 1,
  &#39;extras&#39;: [],
  &#39;fragmentation&#39;: 0,
  &#39;frequency&#39;: 1,
  &#39;future&#39;: [],
  &#39;grand_hamiltonian&#39;: 0.496578425,
  &#39;hamiltonian&#39;: 0.5,
  &#39;itfdf_similarity&#39;: 1,
  &#39;matches&#39;: [&#39;hello&#39;, &#39;world&#39;],
  &#39;missing&#39;: [],
  &#39;name&#39;: &#39;7d0678ba6305341ce0d25133ab086208656a562f&#39;,
  &#39;past&#39;: [],
  &#39;potential&#39;: 4,
  &#39;present&#39;: [[&#39;hello&#39;], [&#39;world&#39;]],
  &#39;similarity&#39;: 1,
  &#39;snr&#39;: 1,
  &#39;type&#39;: &#39;prototypical&#39;},
 {&#39;confidence&#39;: 1,
  &#39;confluence&#39;: 0.3,
  &#39;emotives&#39;: {},
  &#39;entropy&#39;: 0.528771222,
  &#39;evidence&#39;: 0.333333343,
  &#39;extras&#39;: [&#39;hello&#39;],
  &#39;fragmentation&#39;: 0,
  &#39;frequency&#39;: 1,
  &#39;future&#39;: [],
  &#39;grand_hamiltonian&#39;: 0.264385611,
  &#39;hamiltonian&#39;: 0,
  &#39;itfdf_similarity&#39;: 0.94721359,
  &#39;matches&#39;: [&#39;world&#39;],
  &#39;missing&#39;: [],
  &#39;name&#39;: &#39;3b5c9cdc4424988308922d2ec8c7bc06b7c6ac21&#39;,
  &#39;past&#39;: [[&#39;goodbye&#39;], [&#39;cruel&#39;]],
  &#39;potential&#39;: 2.39165807,
  &#39;present&#39;: [[&#39;world&#39;]],
  &#39;similarity&#39;: 0.4,
  &#39;snr&#39;: 0.333333343,
  &#39;type&#39;: &#39;prototypical&#39;}]
</pre></div></div>
</div>
<p>This time around, ‘P1’ produced two predictions. The first is still a prediction of “hello world”, but now the prediction object’s fields have changed. It now believes the current present state to be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;present&#39;: [[&#39;hello&#39;], [&#39;world&#39;]]
</pre></div>
</div>
<p>based on its matches:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;matches&#39;: [&#39;hello&#39;, &#39;world&#39;]
</pre></div>
</div>
<p>It no longer expects to find anything in the future.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;future&#39;: []
</pre></div>
</div>
<p>However, it’s second prediction object sees things a little differently. It is based on the “goodbye cruel world” sequence. Therefore, based on that sequence, it believes the present state to be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;present&#39;: [[&#39;world&#39;]]
</pre></div>
</div>
<p>since it only matched on:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;matches&#39;: [&#39;world&#39;]
</pre></div>
</div>
<p>Since this is its belief for the present state, it is surprised to find the symbol <code class="docutils literal notranslate"><span class="pre">'hello'</span></code> and shows this as an ‘extra’ item:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;extras&#39;: [&#39;hello&#39;]
</pre></div>
</div>
<p>Additionally, based on its belief of the present state, it predicts backwards into the past and says that the events containing the symbols <code class="docutils literal notranslate"><span class="pre">'goodbye'</span></code> and <code class="docutils literal notranslate"><span class="pre">'cruel'</span></code> must have occurred although it did not get a chance to observe them.</p>
</section>
<section id="5.-An-Emotional-Machine:-Emotives-and-Mood">
<h2>5. An Emotional Machine: Emotives and Mood<a class="headerlink" href="#5.-An-Emotional-Machine:-Emotives-and-Mood" title="Permalink to this heading"></a></h2>
<p>The emotives field in the GDF is used to give the agent emotional data. It is used for automatic goal-setting, reinforcement learning, and determining the desirability of an outcome. Examples of emotional data would be cost and time. In order for your agent to learn emotional data you have to populate the emotive field in the GDF with the name of the emotive, and then give it a value; emotives accept non-vector numbers, positive or negative.</p>
<p>Furthermore, emotives can be used to help solve multivariate problems. Let’s start by using one emotive, then later on in the tutorial we will show you how solve problems with multiple emotives.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;all-cleared&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_1</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>

<span class="n">sequence_2</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;goodbye&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cruel&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">40</span><span class="p">}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>
</pre></div>
</div>
</div>
<p>If we decide that the two sequences above are polar opposites in sentiment, and each have their own magnitude in value, we can encode that information as a “emotives” value in the GDF. In the above sequences we have named the emotive, “utility”.</p>
<p>For people, the two sequences provided above have very different emotional context around them. “hello world” may be a happy or neutral sentiment. “goodbye cruel world”, however, has a very negative connotation to it.</p>
<p>NOTE: the positioning of the emotives values within the sequence is irrelevant. We could have just as easily put them in the last event of the sequence, or even created a new event just to supply a emotive value:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_1</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}}]</span>

<span class="n">sequence_2</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;goodbye&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cruel&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">}}]</span>

<span class="c1"># or</span>

<span class="n">sequence_1</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}}]</span>

<span class="n">sequence_2</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;goodbye&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cruel&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
              <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">}}]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;PREDICT&#39;: True,
 &#39;SLEEPING&#39;: False,
 &#39;emotives&#39;: {},
 &#39;last_learned_model_name&#39;: &#39;&#39;,
 &#39;models_kb&#39;: &#39;{KB| objects: 0}&#39;,
 &#39;name&#39;: &#39;P1&#39;,
 &#39;size_WM&#39;: 0,
 &#39;target&#39;: &#39;&#39;,
 &#39;time&#39;: 0,
 &#39;vectors_kb&#39;: &#39;{KB| objects: 0}&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learn the 1st sequence</span>
<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence_1</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MODEL|7d0678ba6305341ce0d25133ab086208656a562f&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learn the 2nd sequence</span>
<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence_2</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MODEL|3b5c9cdc4424988308922d2ec8c7bc06b7c6ac21&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s observe the single event with &quot;hello&quot; in the strings section to get a prediction</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">({</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;observed&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;confidence&#39;: 1,
  &#39;confluence&#39;: 0.4,
  &#39;emotives&#39;: {&#39;utility&#39;: 10},
  &#39;entropy&#39;: 0.464385629,
  &#39;evidence&#39;: 0.5,
  &#39;extras&#39;: [],
  &#39;fragmentation&#39;: 0,
  &#39;frequency&#39;: 1,
  &#39;future&#39;: [[&#39;world&#39;]],
  &#39;grand_hamiltonian&#39;: 0.232192814,
  &#39;hamiltonian&#39;: 0,
  &#39;itfdf_similarity&#39;: 1,
  &#39;matches&#39;: [&#39;hello&#39;],
  &#39;missing&#39;: [],
  &#39;name&#39;: &#39;7d0678ba6305341ce0d25133ab086208656a562f&#39;,
  &#39;past&#39;: [],
  &#39;potential&#39;: 3.5,
  &#39;present&#39;: [[&#39;hello&#39;]],
  &#39;similarity&#39;: 0.666666687,
  &#39;snr&#39;: 1,
  &#39;type&#39;: &#39;prototypical&#39;}]
</pre></div></div>
</div>
<p>The get_predictions command gave back one sequence as a prediction. This sequence has an emotive with the name of “utility” of value 10 in its prediction object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;utility&#39;: 10}
</pre></div></div>
</div>
<p>NOTE: Emotives allow room for decision making based on emotions. Humans make decisions based on emotions all the time but the outcome depends on their mood. A user can set a mood for each emotive in order to give them weights, which will affect the overall utility. More on this later when we create a recommendation engine based on different emotions.</p>
</section>
<section id="6.-Numerical-Data:-Vectors">
<h2>6. Numerical Data: Vectors<a class="headerlink" href="#6.-Numerical-Data:-Vectors" title="Permalink to this heading"></a></h2>
<p>Gaius is able to convert numerical data, in the form of vectors, into symbols for pattern matching. For example, the hand written digits dataset is an example of numerical data where the pixel values will be converted into a flattened vector.</p>
<p>But first let’s talk about vectors and how to format them into a GDF.</p>
<p>A vector is also an array. For example, [1, 1] is a vector. To provide one vector, the data will look like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&quot;strings&quot;: [], &quot;vectors&quot;: [[1, 1]], &quot;emotives&quot;: {}}
</pre></div>
</div>
<p>Notice the two sets of square brackets, [ ]. This is because we are putting an array inside another array. Vector basis values can be any real number, floats or integers.</p>
<p>{“vectors”: [[4.986, 100, 33.12, 33.91]], “strings”: [], “emotives”: {}}</p>
<p>Multiple vectors with the same dimensions form a matrix, and can be processed as matrices by Manipulatives. (Great for image processing.):</p>
<p>{“vectors”: [[230, 188, 255], [125, 39, 64], [14, 138, 220]], “strings”: [], “emotives”: {}}</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s grab the digits dataset from sklearn, and later view some of the digits with matplotlib</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">d</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])):</span>
    <span class="n">flattened_vector</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">]</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>


    <span class="n">sequence</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">flattened_vector</span><span class="p">],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
                <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;label|</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at the first sequence</span>
<span class="c1"># 1st event contains the flattened vector in the vectors field</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2nd event is the label/answer in the strings field</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s verify one of the image of the pixel data</span>
<span class="n">digit_img</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;vectors&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">digit_img</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s view this &#39;0&#39; digit</span>
<span class="n">chunks_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">digit_img</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">digit_img</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
<span class="n">array_chunks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chunks_v</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array_chunks</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;strings&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">label</span>
</pre></div>
</div>
</div>
<p>The label is correct, the pixel data does represent the digit, ‘0’.</p>
<p>Let’s have the agent learn this image using the vector field in the GDF!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fresh start</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get data and label of the 1st digit</span>
<span class="n">event_1</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">event_2</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observe the data</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_1</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at what&#39;s inside the wm</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice that in order to represent the vector as a symbol it has been converted into a hash to uniquely represent that vector</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observed its label so we can teach the agent what it is</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_2</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s teach it another digit</span>
<span class="n">event_1</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">event_2</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_1</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_2</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s observe a new digit to see if it can predict its label</span>
<span class="n">event_1</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># data</span>
<span class="n">event_2</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># label</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_1</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_digit_img</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;vectors&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s view this digit</span>
<span class="n">chunks_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_digit_img</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_digit_img</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
<span class="n">array_chunks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chunks_v</span><span class="p">)</span>
<span class="n">array_chunks_2</span> <span class="o">=</span> <span class="n">array_chunks</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array_chunks_2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s see what the agent predicts this digit is based on the images it has learned</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explore fields of the 1st prediction object from its prediction ensemble</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction = </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;potential  = </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explore fields of the 2nd prediction object from its prediction ensemble</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction = </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;potential  = </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since the agent has two sequences that were learned previously, the ‘0’ and the ‘1’, those are the only two things it can predict when observing new data. We extract the future field of the prediction object in order to get the “prediction”. This is the reason why we observe the label/answer as the 2nd event of the sequences. The strength of the predictions are determined by its potential score.</p>
<p>The first prediction that the agent produced gave the answer ‘1’ with a potential of 2.5. The second prediction gave an answer ‘0’ with a potential of ~1.95. Since the first prediction has a higher potential than the second prediction, the agent has determined that the answer is more likely to be ‘1’, based on what’s in its kb, which is correct in this case. Moreover, by default prediction ensembles are sorted from highest potential to lowest potential. It is up to the user on how they want to
use the information provided in the prediction objects/ensembles.</p>
<p>Questions you might want to answer when using the prediction ensembles:</p>
<p>Do you want to use only the strongest prediction or do you want an average of all predictions?</p>
<p>Do you want the agent to only give a maximum number of predictions of 10 or 100, which you can later use to get the average of predictions?</p>
<p>Again, it is up to you on how you would like to use the prediction objects/ensemble.</p>
<p>For example, let’s say you only care about the strongest prediction an agent might give from a particular node. In this case, just query the first prediction object, which is the strongest prediction because it has the highest potential value in the prediction ensemble.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get 1st prediction object from its prediction ensemble</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction = </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="7.-Attaching-Manipulatives">
<h2>7. Attaching Manipulatives<a class="headerlink" href="#7.-Attaching-Manipulatives" title="Permalink to this heading"></a></h2>
<p>Manipulatives are small bits of code that operate on incoming or outgoing data. They are attached to a primitive. They can be â€˜wiredâ€™ together in series or parallel to achieve certain behavior for an agent. The way these are wired together is called the â€œagentâ€™s topologyâ€. We’ve usee only one primitive earlier but now will use primitives with manipulatives attached to them. But first let’s understand that:</p>
<p>Manipulatives may have configurable parameters called Genetic Configurable Parameters (GCP).</p>
<p>Manipulatives come in 2 flavors:</p>
<p>manipulatives — These take incoming data, operate on it, and return the manipulated data. Incoming data may be streamed from other manipulatives, or from the â€˜observedâ€™ API call.</p>
<p>abstraction manipulatives — manipulates data by filtering selected fields from the prediction object in order to be fed into another primitive in another symbolic form.</p>
<p>Let’s imagine a scenario where you have two primitive nodes all being fed the same emotional data (emotives). You’re interested in buffing up one of those primitives by multiplying its value, but you don’t want to change the input data on the other primitive. You can create a topology where you can manipulate the data of one of those primitive nodes. Let’s practice using the manipulative with that node.</p>
<section id="7a.-Manipulatives">
<h3>7a. Manipulatives<a class="headerlink" href="#7a.-Manipulatives" title="Permalink to this heading"></a></h3>
<p>Let’s use different ingress and query nodes from the genome where there is a manipulative attached to a primitive. The manipulative we’re going to attach is called, “emotiveMultiplier.”</p>
<p>To create this manually in the PVT simple go to Genie Creator, then find the manipulative named, “emotiveMultiplier,” in the ‘Manipulatives’ section, next click &amp; drag the manipulative on top of the ‘P1’ primitive. An arrow from the manipulative node to the P1 primitive should appear. You can edit its GCP by right-clicking on the node, and then clicking on “edit”</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use primitive, P2, to demonstrate Manipulatives</span>
<span class="n">ingress_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P2&#39;</span><span class="p">]</span>
<span class="n">query_nodes</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P2&#39;</span><span class="p">]</span>

<span class="n">agent</span><span class="o">.</span><span class="n">set_ingress_nodes</span><span class="p">(</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">set_query_nodes</span><span class="p">(</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clear out all memory from all nodes just in case you were tinkering around.</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create an event with two symbols, hello and world, with a positive emotional value of 10 in its emotives field</span>
<span class="n">event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">],</span><span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span><span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at what&#39;s in the working memory. Although, the emotive/utility value is not present in the wm</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at the cognition data to see the emotive/utility value. Here the utility = 50, because 10*5=50</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_cognition_data</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">],</span><span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span><span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice that the learned sequence that it matched on originally was fed a emotive/utility value of 10, but because it had a emotiveMulitplier manipulative attached to it the utility for this sequence has been multiplied by 5 to give it a value of 50.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="7b.-Abstraction-Manipulatives-and-Deep-Learning">
<h3>7b. Abstraction Manipulatives and Deep Learning<a class="headerlink" href="#7b.-Abstraction-Manipulatives-and-Deep-Learning" title="Permalink to this heading"></a></h3>
<p>Hierarchies are important structures in natural intelligence devices. (Uh, I mean biological brains!) . Passing processed information from lower layers in a hierarchy for further processing in higher layers leads to interesting outputs such as language and higher-order reasoning. Even in simulated models such as artificial neural networks and convolutional neural networks, hierarchical structures allow separation and extraction of progressively higher-order features from raw data. What is the
functional equivalent of this in our analytical information model?</p>
<p>This is where GAIuS’ abstraction manipulatives come in.</p>
<p>Using abstractions provide some advantages in some use cases, increasing accuracy, precision, and/or other metrics. It is not the case that further processing always results in improved predictions. Some datasets may not have any additional information that can be squeezed out through further processing. Other datasets show clear improvements beyond the lower layers’ predictions.</p>
<p>Each abstraction manipulative isolates a single field from the prediction objects emitting from a cognitive processor, and passes that field’s values to a cognitive processor in the next layer.</p>
<p>The genome topology, ‘demo-all’, provided below for this portion of the tutorial includes a 2-layer hierarchy of nodes. Node P3 is the first layer. The second layer consists of which abstracted data feeds into P4. Each abstraction manipulative isolates a single field from the prediction objects emitting from a cognitive processor, and passes that field’s values to a cognitive processor in the next layer.</p>
<p>As of now, the available fields are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>name
matches
future
missing
extras
present
past
</pre></div>
</div>
<p>Create a new genome where you attach an abstraction manipulative node from a lower node, ‘P1’, to a higher node, ‘P2’. In the Genie Creator, ‘click and drag’ the abstraction manipulative from the ‘Manipulative’ section onto P1. An arrow coming from the node to the abstraction node should appear. Then, ‘right-click and hold’ on the white space in the topology section to select ‘Add Primitive’. A new primitive node, ‘P2’, should appear. ‘Right-click and hold’ on the abstraction node, select ‘Draw
Edge From/To’. The abstraction node and the new primitive node will become highlighted. ‘Right-click and hold’ on the primitive node,‘P2’, select ‘Draw Edge From/To’. An arrow from the abstraction node to P2 should appear. ‘Click and drag’ the nodes so that it will be align vertically. In order to abstract a particular field, ‘right-click and hold’ on the abstraction node to select ‘Edit Properties’. In the value section, you can change which field you want to abstract. For now, let’s leave it
with the default field value, ‘name’, so that we can abstract the name of sequences learned. Spawn a new bottle with this genome.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use primitives P3 &amp; P4</span>
<span class="n">ingress_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P3&quot;</span><span class="p">,</span><span class="s2">&quot;P4&quot;</span><span class="p">]</span>
<span class="n">query_nodes</span>   <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P3&quot;</span><span class="p">,</span><span class="s2">&quot;P4&quot;</span><span class="p">]</span>

<span class="n">agent</span><span class="o">.</span><span class="n">set_ingress_nodes</span><span class="p">(</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">set_query_nodes</span><span class="p">(</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now that the agent learned a sequence. let’s see what happens when the agent observes a similar event that matches what it has in its kb.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_1</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">],</span><span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span><span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_1</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice that the order of the symbols ‘hello’ and ‘friend’ in the strings section were reversed when it reached the wm. This is because there is a parameter in the genome called ‘sort’ which is turned on by default when you create a genome topology using the PVT. The ‘sort’ parameter sorts the strings symbols in alphabetical order.</p>
<p>The name of the primitive and the sequence matched,‘PRIMITIVE|p3ed9a6f8e|name|3814b8c03c137909546d6993c0acf351981bccae’, in its kb has been abstracted out and added to the wm of P4 as a symbol.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;friend&#39;</span><span class="p">],</span><span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span><span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event_2</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">get_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="8.-Gaius-Examples">
<h1>8. Gaius Examples<a class="headerlink" href="#8.-Gaius-Examples" title="Permalink to this heading"></a></h1>
<p>There are 3 types of tests that are common to run: Classification, Utility Polarity, and Utility Value. Depending on the nature of dataset and what the user is trying to get out of the dataset determines which type of test to run. Below are some examples:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use the first primitive for our ingress and query node</span>
<span class="n">ingress_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>
<span class="n">query_nodes</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">]</span>

<span class="n">agent</span><span class="o">.</span><span class="n">set_ingress_nodes</span><span class="p">(</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">set_query_nodes</span><span class="p">(</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Classification problems are problems where sequences include some context (vectors, strings, or mixed), and a specific label string is required to identify that context.</p>
<p>For example, a record from the “iris” dataset consists of sequence with a vector in the first event, and a label as a string in the second event:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event_1_data = {&quot;strings&quot;: [], &quot;vectors&quot;: [[5.1, 3.5, 1.4, 0.2]], &quot;emotives&quot;: {}}
event_2_data = {&quot;strings&quot;: [&quot;setosa&quot;], &quot;vectors&quot;: [], &quot;emotives&quot;: {}}
</pre></div>
</div>
<p>The above two events comprise a single sequence.</p>
<p>Classification problems are easily handled by an agent. Best-practice is to provide the classification as its own event at the end of a sequence. This way, the classification can always be extracted from a prediction by querying the last event in the ‘future’ field. All the prior events provide the contextual data for the classification. This can be one or more events containing strings and/or vectors. Therefore, your sequence for classification problems must contain at least two events during
training.</p>
<p>For “classification” problems, you will remove the last symbol from the last event of the “strings” field in a sequence during the testing phase. Once the answer-free data is ingested (via “observe” API calls), the system is queried (via “getPredictions” API calls) for its predictions. If the prediction matches the historic answer, then the test marks the prediction as correct. If not, then it is marked as incorrect. After the predictions are returned and tallied, the correct answer will be
provided to the agent’s <em>query</em> nodes as its own event containing the classification in the “strings” field to continue learning.</p>
<p>The way this works is that the historic data must include the answers in order to measure the performance of the agent. Each of the sequences are independent of each other. If using files for the datasets, then each sequence must be in its own file. Each row in that file must contain a JSON dump of the GDF object. Each file must contain only one full sequence. All of these sequence files must be placed in a single directory.</p>
<p>For example, this will convert the iris dataset into files stored in a directory:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># get iris dataset from sklearn</span>
<span class="n">iris_data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="c1"># define paths to create/use</span>
<span class="n">datasets_file_path</span>     <span class="o">=</span> <span class="s1">&#39;../data/gdf_folder/testset&#39;</span>
<span class="n">iris_dataset_file_path</span> <span class="o">=</span> <span class="s1">&#39;../data/gdf_folder/testset/iris-flowers&#39;</span>

<span class="c1"># check to see if path exist, if not, then create it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">datasets_file_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">datasets_file_path</span><span class="p">)</span>

<span class="c1"># check to see if path exist, if not, then create it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">iris_dataset_file_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">iris_dataset_file_path</span><span class="p">)</span>

<span class="c1"># iterate through testset to create a folder with sequences for training and testing purposes</span>
<span class="c1"># every file will have two events. The first event will have descriptive data while the second event will have the label</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])):</span>

    <span class="n">iris_vector_data</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">iris_label</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">]</span> <span class="p">[</span><span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

    <span class="n">sequence</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">iris_vector_data</span><span class="p">],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}},</span>
                <span class="p">{</span><span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;label|</span><span class="si">{</span><span class="n">iris_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">iris_dataset_file_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">iris_label</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Earlier we were able to change the gene parameters of the Genome before we spawned an agent. However, you may want to change them afterwards. For the Iris dataset we are going to decrease the recall threshold gene parameter to increase the response rate when making a prediction. Again, ‘recall_threshold’ is the minimum likeness of the observed sequence against known sequences for it to be returned as a prediction. The smaller the threshold, the less the observed needs to match the known. The
higher the threshold, the more similar the known must be to the observed for it to be returned as a prediction. Values 0 &lt; x &lt;= 1. Typically between 0.2-0.8. Let’s increase max_predictions 10.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check recall threshold of P1 with get_gene method</span>
<span class="k">for</span> <span class="n">prim</span> <span class="ow">in</span> <span class="n">ingress_nodes</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prim</span> <span class="o">==</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="s2">&quot;recall_threshold&quot;</span><span class="p">,</span> <span class="n">prim</span><span class="p">),</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="s2">&quot;max_predictions&quot;</span><span class="p">,</span> <span class="n">prim</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change the recall threshold and max predictions gene</span>
<span class="k">for</span> <span class="n">prim</span> <span class="ow">in</span> <span class="n">ingress_nodes</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prim</span> <span class="o">==</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">change_genes</span><span class="p">({</span><span class="s2">&quot;recall_threshold&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span> <span class="p">[</span><span class="n">prim</span><span class="p">])</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">change_genes</span><span class="p">({</span><span class="s2">&quot;max_predictions&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span> <span class="p">[</span><span class="n">prim</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check changed recall threshold of P1 with get_gene method</span>
<span class="k">for</span> <span class="n">prim</span> <span class="ow">in</span> <span class="n">ingress_nodes</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prim</span> <span class="o">==</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="s2">&quot;recall_threshold&quot;</span><span class="p">,</span> <span class="n">prim</span><span class="p">),</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="s2">&quot;max_predictions&quot;</span><span class="p">,</span> <span class="n">prim</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use the gaius data_ops library to split the data into training and testing sets</span>
<span class="kn">from</span> <span class="nn">ia.gaius</span> <span class="kn">import</span> <span class="n">data_ops</span>

<span class="n">iris_dataset</span> <span class="o">=</span> <span class="n">data_ops</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">data_directories</span><span class="o">=</span><span class="p">[</span><span class="n">iris_dataset_file_path</span><span class="p">])</span>
<span class="n">iris_dataset</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">percent_of_dataset_chosen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">percent_reserved_for_training</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">train_sequences</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">test_sequences</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NOTE: Remember when training sequences to agents to keep the convention of clear_wm –&gt; observe events–&gt; learn sequence</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check if bottle has no data in kb</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Agent</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">):</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sequence_file</span><span class="p">:</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>

            <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show status</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice the models_kb has been updated. For vector data the agent keeps track of vectors separately.</p>
<p>For testing, clear_wm –&gt; observe –&gt; get_predictions –&gt; learn</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test Agent</span>
<span class="n">iris_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">iris_actuals</span>     <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">):</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sequence_file</span><span class="p">:</span>

        <span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>

        <span class="c1"># observe up to last event, which has the answer</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

            <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="c1"># get and store predictions after observing events</span>
        <span class="n">iris_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">))</span>

        <span class="c1"># store answers in a separate list for evaluation</span>
        <span class="n">iris_actuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># observe answer</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># learn answer (optional continous learning)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">iris_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The prediction object gives an ensemble of predictions based on the max prediction gene parameter. The predictions are sorted by the potential score, strength of prediction, by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s take a look at the first prediction ensemble with pretty print</span>
<span class="kn">import</span> <span class="nn">pprint</span> <span class="k">as</span> <span class="nn">pprint</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diving into this list of dictionaries we can get the amount of predictions given by P1</span>
<span class="nb">len</span><span class="p">(</span><span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Since this is a classification problem we will set the label to be the second event of every sequence so that we can query out the future field of the prediction object. For example, let’s look at the top two predictions for the first prediction:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># top prediction</span>
<span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The potential score for the top prediction</span>
<span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second strongest prediction</span>
<span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The potential score for the second strongest prediction</span>
<span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Both predictions state that ‘versicolor’ is the answer based on sequences it learned prior. To get the name of the sequence that it matched on just query the ‘name’ field. This is useful when trying to explain why the agent gave a particular answer, hence, Explainable Artificial Intelligence (EAI). For instance,:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>A user can use all of the predictions to tally them up to get an overall score or a user can simply just use the strongest prediction.</p>
<p>For this tutorial we will only use the top predictions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s see how well the agent scores based on the top predictions</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">iris_top_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">iris_answers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">iris_predictions</span><span class="p">)):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">iris_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iris_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;future&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># if the agent doesn&#39;t have enough information to make a prediction it wouldn&#39;t give one</span>
        <span class="n">iris_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>

    <span class="n">iris_answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iris_actuals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;strings&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">iris_answers</span><span class="p">,</span><span class="n">iris_top_predictions</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take a look at the top predictions</span>
<span class="n">iris_top_predictions</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take a look at the answers</span>
<span class="n">iris_answers</span>
</pre></div>
</div>
</div>
<p>Sometimes, all you want is to know if the output is positive or negative, true or false, yes or no. For example, on customer churn data sets where a customers profile data of staying/leaving is converted with a +100/-100 emotive value, respectively, you simply want to know if the customer will leave or not. You may also want to have a probability associated with this. For testing purposes, though, we need an absolute answer rather than probabilities. So, if the system predicts a negative utility
regardless of the magnitude, then it is considered a prediction that the customer will churn.</p>
<p>For “utility polarity” problems, you will remove and store the values from “emotives” during testing prior to sending to the ingress nodes. (Obviously, it will not remove those answers during training.) Once the answer-free data is ingested (via “observe” API calls), the system is queried (via “getPredictions” API calls) for its predictions. If the prediction matches the historic answer, then the test marks the prediction as correct. If not, then it is marked as incorrect. After the predictions
are returned and tallied, the correct answer will be provided to the agent as its own event containing the utility in the “emotives” field to continue learning. Note that if a sequence contains emotives in multiple events, all of them will be stripped of their emotives values and the sum will be used as the historic answer.</p>
<p>For each prediction, the “utility polarity” converts the emotive “utility” value field into a positive/negative classification for tallying.</p>
<p>Let’s practice training and testing an agent from a csv file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">churn_csv_file_path</span> <span class="o">=</span> <span class="s1">&#39;../data/churn.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">churn_csv_file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a glance of what the data looks like</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking if there are only two values for this column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn?&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># split into training and testing sets from pandas dataframe</span>
<span class="n">percentage_split</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">size</span>      <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">train_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="n">percentage_split</span><span class="p">)</span>

<span class="n">training_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="n">train_num</span><span class="p">]</span>
<span class="n">testing_df</span>  <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">train_num</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">training_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">testing_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get all feature columns to use in a list</span>
<span class="c1"># Excluding the phone columns because phone numbers are unique values which doesn&#39;t provide any useful data for pattern matching</span>
<span class="c1"># Excluding the churn column because that is what we&#39;ll use for the answer.</span>
<span class="n">feature_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Phone&#39;</span><span class="p">,</span><span class="s1">&#39;Churn?&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">feature_columns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_for_output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Churn?&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show status</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert and split training and testing row data into a list of dictionaries</span>
<span class="n">train_list_of_dicts_from_rows</span> <span class="o">=</span> <span class="n">training_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="n">test_list_of_dicts_from_rows</span> <span class="o">=</span> <span class="n">testing_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For this dataset, we will use the | Pipe Character to categorize certain features with an associated value. This is helpful when running an information analysis on the dataset. This helps give insights on the data by determining key indicators and helping to separate signal from noise. For example, a customer’s state location might be useful when pattern matching. Let’s say a customer lives in NY. We will convert that to ‘State|NY’ so that if another customer was from NY there would possible be
some correletion between the two. But don’t worry about that. Let Gaius connect the dots for you.</p>
<p>Note: You can supply multiple layers of categories when using the pipe character. For example, this GDF:</p>
<p>{“vectors”: [], “strings”: [“fruit|apple”, “fruit|banana”, “vegetable|celery”], “emotives”: {}}</p>
<p>can be expanded to:</p>
<p>{“vectors”: [], “strings”: [“food|fruit|apple”, “food|fruit|banana”, “food|vegetable|celery”], “emotives”: {}}</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get and modify data to insert into appropriate gdf sequence lists</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dict_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_list_of_dicts_from_rows</span><span class="p">):</span>

    <span class="c1"># make sure nothing is in wm before observing new data</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="c1"># reset variables</span>
    <span class="n">profile_data_piped_strings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">churn_polarity_value</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># get key and values from each row to make profile data using the pipe character</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">feature_columns</span><span class="p">:</span>

            <span class="n">profile_data_piped_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">column_for_output</span><span class="p">:</span>

            <span class="c1"># converting true and false to positive and negative values to insert into emotives utility field</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;True.&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mi">100</span>

            <span class="n">churn_polarity_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="c1"># convert data to gdf</span>
    <span class="n">profile_data_gdf</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vectors&quot;</span><span class="p">:[],</span> <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="n">profile_data_piped_strings</span><span class="p">,</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">churn_polarity_gdf</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vectors&quot;</span><span class="p">:[],</span> <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;utility&quot;</span><span class="p">:</span> <span class="n">churn_polarity_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]}}</span>

    <span class="c1"># observe events, and then learn sequence</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">profile_data_gdf</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">churn_polarity_gdf</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">churn_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">churn_actuals</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># get and modify data to insert into appropriate gdf sequence lists</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dict_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_list_of_dicts_from_rows</span><span class="p">[:</span><span class="mi">10</span><span class="p">]):</span>

    <span class="c1"># make sure nothing is in wm before observing new data</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="c1"># reset variables</span>
    <span class="n">profile_data_piped_strings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">churn_polarity_value</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># get key and values from each row to make profile data using the pipe character</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">feature_columns</span><span class="p">:</span>

            <span class="n">profile_data_piped_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">column_for_output</span><span class="p">:</span>

            <span class="c1"># converting true and false to positive and negative values to insert into emotives utility field</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;True.&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mi">100</span>

            <span class="n">churn_polarity_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="c1"># convert data to gdf</span>
    <span class="n">profile_data_gdf</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vectors&quot;</span><span class="p">:[],</span> <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="n">profile_data_piped_strings</span><span class="p">,</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">churn_polarity_gdf</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vectors&quot;</span><span class="p">:[],</span> <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;utility&quot;</span><span class="p">:</span> <span class="n">churn_polarity_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]}}</span>

    <span class="c1"># observe events, and then learn sequence</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">profile_data_gdf</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="c1"># get all predictions into a list</span>
    <span class="n">churn_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">))</span>

<span class="c1">#     get all historical answers for later analysis</span>
    <span class="n">churn_actuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">churn_polarity_value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#     learn the answer</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">churn_polarity_gdf</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show status</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This time instead of extracting the ‘future’ field from the prediction object we will extract the ‘emotives’ field, instead. For example, let’s look at the top prediction of the first prediction,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">churn_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The above utility score means that the customer stayed, ‘False.’, which we converted +100</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again we are going to use the top predictions only</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">churn_top_predictions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">churn_predictions</span><span class="p">)):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">churn_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">churn_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">])</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># if the agent doesn&#39;t have enough information to make a prediction it wouldn&#39;t give one</span>
        <span class="n">churn_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">churn_actuals</span><span class="p">,</span><span class="n">churn_top_predictions</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Other times, you need to predict actual numeric values. For example, in the Boston housing market data sets, the goal is to predict house prices. These can be recorded as emotive values. It is obviously rare to have negative house prices, so the polarity report wouldn’t be helpful. Instead, we’re interested in predicting the actual market price of each house.</p>
<p>This problem type works identically to the one above, except it retains the numeric value at the end instead of converting it into a positive/negative classification.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fresh start</span>
<span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># get data</span>
<span class="n">boston</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">datasets_file_path</span>     <span class="o">=</span> <span class="s1">&#39;../data/gdf_folder/testset&#39;</span>
<span class="n">bhp_dataset_file_path</span>  <span class="o">=</span> <span class="s1">&#39;../data/gdf_folder/testset/boston_house_prices&#39;</span>

<span class="c1"># check to see if path exist, if not, then create it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">datasets_file_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">datasets_file_path</span><span class="p">)</span>

<span class="c1"># check to see if path exist, if not, then create it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">bhp_dataset_file_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">bhp_dataset_file_path</span><span class="p">)</span>

<span class="n">numberofrecord</span> <span class="o">=</span> <span class="n">boston</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span>  <span class="n">boston</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">boston</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span><span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span> <span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberofrecord</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>


    <span class="n">profile_data_piped_strings</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">house_price</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">sequence</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;strings&#39;</span><span class="p">:</span> <span class="n">profile_data_piped_strings</span><span class="p">,</span> <span class="s1">&#39;vectors&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;emotives&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                <span class="p">{</span><span class="s1">&#39;strings&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vectors&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;emotives&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;utility&quot;</span><span class="p">:</span> <span class="n">house_price</span><span class="p">}}]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bhp_dataset_file_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use the gaius data_ops library to split the data into training and testing sets</span>
<span class="kn">from</span> <span class="nn">ia.gaius</span> <span class="kn">import</span> <span class="n">data_ops</span>

<span class="n">bhp_dataset</span> <span class="o">=</span> <span class="n">data_ops</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">data_directories</span><span class="o">=</span><span class="p">[</span><span class="n">bhp_dataset_file_path</span><span class="p">])</span>
<span class="n">bhp_dataset</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">percent_of_dataset_chosen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">percent_reserved_for_training</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">train_sequences</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">test_sequences</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check if bottle has no data in kb</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Agent</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">):</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sequence_file</span><span class="p">:</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>

            <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show status</span>
<span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice the models_kb has been updated. For vector data the agent keeps track of vectors separately.</p>
<p>For testing, clear_wm –&gt; observe –&gt; get_predictions –&gt; learn</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test Agent</span>
<span class="n">bhp_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bhp_actuals</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">):</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bhp_dataset</span><span class="o">.</span><span class="n">test_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sequence_file</span><span class="p">:</span>

        <span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>

        <span class="c1"># observe up to last event, which has the answer</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

            <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="c1"># get and store predictions after observing events</span>
        <span class="n">bhp_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">))</span>

        <span class="c1"># store answers in a separate list for evaluation</span>
        <span class="n">bhp_actuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># observe answer</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="c1"># learn answer (optional continous learning)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The prediction object gives an ensemble of predictions based on the max prediction gene parameter. The predictions are sorted by the potential score, strength of prediction, by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s take a look at the first prediction ensemble with pretty print</span>
<span class="kn">import</span> <span class="nn">pprint</span> <span class="k">as</span> <span class="nn">pprint</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diving into this list of dictionaries we can get the amount of predictions given by P1</span>
<span class="nb">len</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># top prediction</span>
<span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The potential score for the top prediction</span>
<span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second strongest prediction</span>
<span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The potential score for the second strongest prediction</span>
<span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;potential&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>A user can use all of the predictions to tally them up to get an overall score or a user can simply just use the strongest prediction.</p>
<p>For this tutorial we will only use the top predictions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bhp_actuals</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">mean</span>

<span class="n">bhp_top_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bhp_answers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">)):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">bhp_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># depending on recall threshold and dataset agents may not have enough information to make a prediction;</span>
        <span class="c1"># and, therefore will not provide one. In order to get certain metric evaluations it is best to replace non-predictions</span>
        <span class="c1"># For this test we will replace non-predictions with nan values, but this is up to the user.</span>
        <span class="c1"># Agents will either give a prediction or it won&#39;t. It is up to the user on how they want to use that information.</span>
        <span class="n">bhp_top_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">bhp_answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bhp_actuals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;utility&#39;</span><span class="p">])</span>

<span class="c1"># calculate errors removing unknown predictions</span>
<span class="n">bhp_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bhp_top_predictions</span><span class="p">,</span> <span class="n">bhp_answers</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)]</span>

<span class="c1"># It is often a good idea to see what percentage was the Agent able to make predictions.</span>
<span class="c1"># For example, out of 100 tests 60 of them Agent was able to give predictions</span>
<span class="c1"># Therefore, that would give a response rate of 60%</span>

<span class="c1"># calculate response rate percentage</span>
<span class="n">orig_pred_length</span>      <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bhp_predictions</span><span class="p">)</span>
<span class="n">results_preds_updated</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bhp_top_predictions</span> <span class="k">if</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)]</span>
<span class="n">updated_pred_length</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results_preds_updated</span><span class="p">)</span>
<span class="n">response_rate</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">updated_pred_length</span> <span class="o">/</span> <span class="n">orig_pred_length</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># calculate symmetric mean absolute percentage error (sMAPE), an accuracy metric</span>
<span class="n">smape</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">bhp_answers</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bhp_answers</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bhp_top_predictions</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bhp_answers</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bhp_top_predictions</span><span class="p">)))</span>

<span class="c1"># calculate root mean squared error (rmse), another accuracy metric</span>
<span class="n">bhp_errors_squared</span>      <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bhp_errors</span><span class="p">]</span>
<span class="n">bhp_errors_mean</span>         <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">bhp_errors_squared</span><span class="p">)</span>
<span class="n">root_mean_squared_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">bhp_errors_mean</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Response Rate  = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">response_rate</span><span class="p">)</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sMAPE Accuracy = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">smape</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMSE           = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">root_mean_squared_error</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="10.-Advanced-Gaius-Examples">
<h1>10. Advanced Gaius Examples<a class="headerlink" href="#10.-Advanced-Gaius-Examples" title="Permalink to this heading"></a></h1>
<section id="10a.-Building-a-Recommendation-Engine-with-Emotives">
<h2>10a. Building a Recommendation Engine with Emotives<a class="headerlink" href="#10a.-Building-a-Recommendation-Engine-with-Emotives" title="Permalink to this heading"></a></h2>
<p>We will use the Auto Miles Per Gallon (MPG) Dataset to demonstrate predicting two conflicting variables. Conflicting emotives would be 2 or more emotives that are not independent or mutually exclusive of each other. Meaning, they are inversely correlated to each other. A higher (positive) value for one is a lower (negative) value for the other. Horsepower and MPG are inversely related. We will use emotives to predict these two dependant variables, and then use the ‘missing’ field in the
prediction object to provide recommendations.</p>
<section id="Imports">
<h3>Imports<a class="headerlink" href="#Imports" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="kn">from</span> <span class="nn">ia.gaius.agent_client</span> <span class="kn">import</span> <span class="n">AgentClient</span>
<span class="kn">from</span> <span class="nn">ia.gaius.prediction_models</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</section>
<section id="Functions">
<h3>Functions<a class="headerlink" href="#Functions" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_gdf</span><span class="p">(</span><span class="n">strings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">emotives</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create GDF using supplied list of strings, vectors, and/or emotives</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">vectors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">vectors</span><span class="p">,</span>
        <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">strings</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">strings</span><span class="p">,</span>
        <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">emotives</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">emotives</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">gdf</span>


<span class="k">def</span> <span class="nf">log_progress</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">every</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Items&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A nice little Jupyter progress bar widget from: https://github.com/alexanderkuk/log-progress</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">IntProgress</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">VBox</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

    <span class="n">is_iterator</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">is_iterator</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">every</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">every</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span>     <span class="c1"># every 0.5%</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">every</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;sequence is iterator, set every&#39;</span>

    <span class="k">if</span> <span class="n">is_iterator</span><span class="p">:</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">IntProgress</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">progress</span><span class="o">.</span><span class="n">bar_style</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">IntProgress</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">HTML</span><span class="p">()</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">,</span> <span class="n">progress</span><span class="p">])</span>
    <span class="n">display</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">%</span> <span class="n">every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_iterator</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">: </span><span class="si">{index}</span><span class="s1"> / ?&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">index</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">progress</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">index</span>
                    <span class="n">label</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">: </span><span class="si">{index}</span><span class="s1"> / </span><span class="si">{size}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">size</span>
                    <span class="p">)</span>
            <span class="k">yield</span> <span class="n">record</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">progress</span><span class="o">.</span><span class="n">bar_style</span> <span class="o">=</span> <span class="s1">&#39;danger&#39;</span>
        <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">progress</span><span class="o">.</span><span class="n">bar_style</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
        <span class="n">progress</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">index</span>
        <span class="n">label</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">: </span><span class="si">{index}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span> <span class="ow">or</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">train_genie</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">fresh_start</span><span class="p">,</span> <span class="n">ingress_nodes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Train a bottle with the given dataset using the simple algorithm for</span>
<span class="sd">    each sequence:</span>
<span class="sd">        clearWM -&gt; observe -&gt; learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fresh_start</span><span class="p">:</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">clear_all_memory</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

    <span class="c1"># Train Agent</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">log_progress</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Training sequence&quot;</span><span class="p">)):</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sequence_file</span><span class="p">:</span>

            <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>

                <span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>

        <span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Data-Processing">
<h3>Data Processing<a class="headerlink" href="#Data-Processing" title="Permalink to this heading"></a></h3>
</section>
<section id="Dataset-Information">
<h3>Dataset Information<a class="headerlink" href="#Dataset-Information" title="Permalink to this heading"></a></h3>
<p>Source:</p>
<p>This dataset was taken from the StatLib library which is maintained at Carnegie Mellon University. The dataset was used in the 1983 American Statistical Association Exposition.</p>
<p>Data Set Information:</p>
<p>This dataset is a slightly modified version of the dataset provided in the StatLib library. In line with the use by Ross Quinlan (1993) in predicting the attribute “mpg”, 8 of the original instances were removed because they had unknown values for the “mpg” attribute. The original dataset is available in the file “auto-mpg.data-original”.</p>
<p>“The data concerns city-cycle fuel consumption in miles per gallon, to be predicted in terms of 3 multivalued discrete and 5 continuous attributes.” (Quinlan, 1993)</p>
<p>Attribute Information:</p>
<ol class="arabic simple">
<li><p>mpg: continuous</p></li>
<li><p>cylinders: multi-valued discrete</p></li>
<li><p>displacement: continuous</p></li>
<li><p>horsepower: continuous</p></li>
<li><p>weight: continuous</p></li>
<li><p>acceleration: continuous</p></li>
<li><p>model year: multi-valued discrete</p></li>
<li><p>origin: multi-valued discrete</p></li>
<li><p>car name: string (unique for each instance)</p></li>
</ol>
<p>We’re going to build a sample recommendation engine/layer using conflicting emotives. We’re going to train the agent on automobile fuel efficiency (mpg) data. Then, we are going to give the agent two emotives, horsepower and mpg. At certain times we’re going to change moods in order for the agent to recommend a car based on certain emotions, i.e. what you care about. For example, after the agent has certain knowledge about cars and their specs, what would the agent recommend if the user favored
more about specific specs over other specs?</p>
<p>This example will be in the form of a scenario where the user has built a recommendation engine. We’re going to ask the agent for recommendations based on input data and what mood you’re in.</p>
<p>The agent will pattern match on sequences that you’ve trained it on. After observing input data the agent will attempt to provide predictions for the user. We will use the ‘missing’ field from the prediction object in order to provide recommendations. We will use the ‘missing’ field because the agent, after observing the data, matches on sequences that are in its knowledge base. The ‘missing’ field shows what the agent expected to be in an event of a particular sequence in its kb but isn’t
there. That is how we can use the ‘missing’ field to provide recommendations!</p>
<p>Let’s imagine that a user wanted a recommendation of cars that has 4 cylinders and was manufactured in the year 1982.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls ../data
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read data</span>
<span class="n">auto_mpg_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/auto-mpg.csv.xls&#39;</span><span class="p">)</span>
<span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check datatype of dataset</span>
<span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<p>Notice horsepower datatype is ‘object’ which means there might be a discrepancy in the data. Let’s explore:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">horsepower</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>There is a string ‘?’ in the data, so let’s remove these from the dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="p">[</span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">horsepower</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">horsepower</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">horsepower</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">horsepower</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get feature columns</span>
<span class="n">auto_mpg_predictive_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="s1">&#39;horsepower&#39;</span><span class="p">]</span>
<span class="n">auto_mpg_unique_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;car name&#39;</span><span class="p">]</span>
<span class="n">auto_mpg_feature_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">auto_mpg_predictive_columns</span><span class="p">))</span>
<span class="n">auto_mpg_feature_columns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_list_of_dicts_from_rows</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">auto_mpg_list_of_dicts_from_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get data from dataframe to plot graph</span>
<span class="n">mpg_data</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">horsepower_data</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot inverse relation of mpg vs horsepower</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">mpg_data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">horsepower_data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MPG vs Horspower&quot;</span><span class="p">)</span>          <span class="c1"># title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;MPG&quot;</span><span class="p">)</span>                      <span class="c1"># x label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">)</span>               <span class="c1"># y label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define where you will put all sequences</span>
<span class="n">HP_MPG_GDF_DUMP_PATH</span>                <span class="o">=</span> <span class="s1">&#39;../data/gdf_folder/hp_mpg_gdfs&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert mpg data into an array</span>
<span class="n">arr_mpg_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mpg_data</span><span class="p">)</span>
<span class="n">arr_mpg_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># normalize mpg data</span>
<span class="n">normalized_mpg_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="n">arr_mpg_data</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">normalized_mpg_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normalized_mpg_data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert hp data into an array, and then normalize</span>
<span class="n">arr_hp_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">horsepower_data</span><span class="p">)</span>
<span class="n">normalized_hp_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="n">arr_hp_data</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normalized_hp_data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot inverse relation of mpg vs horsepower</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">normalized_mpg_data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">normalized_hp_data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MPG vs Horspower&quot;</span><span class="p">)</span>          <span class="c1"># title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;MPG&quot;</span><span class="p">)</span>                      <span class="c1"># x label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">)</span>               <span class="c1"># y label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update dataframe with normalized mpg and horsepower arrays</span>
<span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized_mpg_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized_hp_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_list_of_dicts_from_rows</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">auto_mpg_list_of_dicts_from_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Create-Emotive-GDFs-for-Horsepower-and-MPG-Loads-Dataset">
<h2>Create Emotive GDFs for Horsepower and MPG Loads Dataset<a class="headerlink" href="#Create-Emotive-GDFs-for-Horsepower-and-MPG-Loads-Dataset" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check to see if path exist, if not, then create it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">HP_MPG_GDF_DUMP_PATH</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">HP_MPG_GDF_DUMP_PATH</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dict_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">auto_mpg_list_of_dicts_from_rows</span><span class="p">):</span>

    <span class="c1"># reset variables</span>
    <span class="n">profile_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">horsepower</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mpg</span>          <span class="o">=</span> <span class="mi">0</span>
    <span class="n">car_name</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">auto_mpg_feature_columns</span><span class="p">:</span>

            <span class="n">profile_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">auto_mpg_unique_id</span><span class="p">:</span>

                <span class="c1"># we&#39;ll use the name of the vehicle to name the files</span>
                <span class="n">car_name</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">car_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">ch</span><span class="o">.</span><span class="n">isspace</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">auto_mpg_predictive_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>

            <span class="n">horsepower</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">auto_mpg_predictive_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>

            <span class="n">mpg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;investigate </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># create gdf</span>
    <span class="n">profile_data_event</span> <span class="o">=</span> <span class="n">create_gdf</span><span class="p">(</span><span class="n">strings</span><span class="o">=</span><span class="n">profile_data</span><span class="p">,</span><span class="n">emotives</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;horsepower&#39;</span><span class="p">:</span> <span class="n">horsepower</span><span class="p">,</span> <span class="s1">&#39;mpg&#39;</span><span class="p">:</span> <span class="n">mpg</span><span class="p">})</span>

    <span class="c1"># create sequence files</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">HP_MPG_GDF_DUMP_PATH</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">car_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">profile_data_event</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_dataset</span> <span class="o">=</span> <span class="n">data_ops</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">data_directories</span><span class="o">=</span><span class="p">[</span><span class="n">HP_MPG_GDF_DUMP_PATH</span><span class="p">])</span>
<span class="n">auto_mpg_dataset</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">percent_of_dataset_chosen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">percent_reserved_for_training</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NOTE: When building a recommendation engines/layers with an agent it doesn’t make sense to create a testing set because recommendations are evaluated by the user.</p>
<section id="Training-Agent">
<h3>Training Agent<a class="headerlink" href="#Training-Agent" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_genie</span><span class="p">(</span><span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span><span class="n">dataset</span><span class="o">=</span><span class="n">auto_mpg_dataset</span><span class="o">.</span><span class="n">train_sequences</span><span class="p">,</span><span class="n">fresh_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ingress_nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s change the recall threshold to 0.3 to increase the minimum likelihood of matching</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;recall_threshold&#39;</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">change_genes</span><span class="p">(</span><span class="n">gene_data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;recall_threshold&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span> <span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">get_gene</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;recall_threshold&#39;</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Ask-the-Agent-for-Recommendations">
<h3>Ask the Agent for Recommendations<a class="headerlink" href="#Ask-the-Agent-for-Recommendations" title="Permalink to this heading"></a></h3>
<p>“Hey Agent, recommend a car that has 4 cylinders that was manufactured in 1982” - User</p>
<p>“Okay, let me help you with that … one moment please …” - Agent</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">clear_wm</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vectors&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cylinders|4&quot;</span><span class="p">,</span> <span class="s2">&quot;model year|82&quot;</span><span class="p">],</span> <span class="s2">&quot;emotives&quot;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">agent</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">event</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="n">ingress_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get predictions</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">query_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hp_mpg_mood_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;horsepower&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;mpg&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="n">hp_mpg_mood_data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sorting prediction object based on the combine power of emotives, mood, and potential</span>
<span class="n">sorted_preds_utility</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(((</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">hp_mpg_mood_data</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">hp_mpg_mood_data</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;potential&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sorted_preds_utility</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;matches&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>By default, the prediction ensemble is sorted by potential, prediction strength, but we’re going to sort the prediction ensemble by utility.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_recommendation_specs</span> <span class="o">=</span> <span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">first_recommendation_specs</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;car name|&#39;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Based on your input the agent recommends &#39;</span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Depending on your emotional state your mood will change. You will favor one emotion over the other at certain times. For example, let’s imagine that you’ve just read an article about imminent increase of gas prices. This new information affected your emotional state where you care more about mpg over horsepower.</p>
<p>“Hey Agent! Please update my horsepower mood weight to 0.5 and mpg mood weight to 1.5. Please give me a new car recommendation.” - User</p>
<p>“Okay, let me help you with that … one moment please …” - Agent</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hp_mpg_mood_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;horsepower&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mpg&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="n">hp_mpg_mood_data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sorting prediction object based on the combine power of emotives, mood, and potential</span>
<span class="n">sorted_preds_utility</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(((</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">hp_mpg_mood_data</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;emotives&#39;</span><span class="p">][</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">hp_mpg_mood_data</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;potential&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sorted_preds_utility</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;matches&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>By default, the prediction ensemble is sorted by potential, prediction strength, but we’re going to sort the prediction ensemble by utility.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_recommendation_specs</span> <span class="o">=</span> <span class="n">sorted_preds_utility</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">second_recommendation_specs</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;car name|&#39;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Based on your input the agent recommends &#39;</span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Great job! You’re all set to giving your Agent emotions. Feel free to change your mood from time to time in order to find predictions that fit your needs. Have fun!</p>
<section id="Sample-Data-sets:">
<h4>Sample Data sets:<a class="headerlink" href="#Sample-Data-sets:" title="Permalink to this heading"></a></h4>
<p>For classification: - “iris-flowers”</p>
<p>For utility polarity: - “customer churn”</p>
<p>For utility value: - “boston house prices”</p>
<p>For emotives: - “auto mpg”</p>
</section>
<section id="References:">
<h4>References:<a class="headerlink" href="#References:" title="Permalink to this heading"></a></h4>
<p><a class="reference external" href="https://www.kaggle.com/arshid/iris-flower-dataset">https://www.kaggle.com/arshid/iris-flower-dataset</a></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Iris_flower_data_set">https://en.wikipedia.org/wiki/Iris_flower_data_set</a></p>
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html#sklearn.datasets.load_iris">https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html#sklearn.datasets.load_iris</a></p>
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston">https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston</a></p>
<p><a class="reference external" href="https://www.kaggle.com/sagnikpatra/edadata">https://www.kaggle.com/sagnikpatra/edadata</a></p>
<p><a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/auto+mpg">https://archive.ics.uci.edu/ml/datasets/auto+mpg</a></p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Intelligent Artifacts Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>